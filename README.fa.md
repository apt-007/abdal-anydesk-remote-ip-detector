# AnyDesk IP Leak Vulnerability CVE-2024-52940

## ๐ค ุชุฑุฌูู ุงุทูุงุนุงุช ูุฑู ุงูุฒุงุฑ
- [English](README.md)
- [Deutsch](README.de.md)
- [ูุงุฑุณ](README.fa.md)

## ๐ธ ูพุด ููุงุณ
 
<p align="center"><img src="abdal-anydesk-remote-ip-detector-proof.gif?raw=true"></p>

## ๐ฅ ูุฏููุง ุงุซุจุงุช ุขุณุจโูพุฐุฑ

ุจุฑุง ูุดุงูุฏู ุนููฺฉุฑุฏ **ุขุณุจโูพุฐุฑ ูุดุช ุขโูพ AnyDesk**ุ ูโุชูุงูุฏ ูุฏููุง ุงุซุจุงุช ุขุณุจโูพุฐุฑ (PoC) ุฒุฑ ุฑุง ุฏุงูููุฏ ฺฉูุฏ:

- [๐ฅ ุฏุงูููุฏ ูุฏู ุงุซุจุงุช ฐฑ](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof.mp4)
- [๐ฅ ุฏุงูููุฏ ูุฏู ุงุซุจุงุช ฐฒ](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof-2.mp4)
- ูพุดููุงุฏ - [๐ฅ ุฏุงูููุฏ ูุฏู ุงุซุจุงุช ฐณ](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof-3.mp4)

ุงู ูุฏููุง ูุญูู ุนููฺฉุฑุฏ ุขุณุจโูพุฐุฑ ุฑุง ูุดุงู ูโุฏููุฏ ู ูุฑุงุญู ู ุชุฃุซุฑ ุขู ุจุฑ ุญุฑู ุฎุตูุต ุขุฏุฑุณ ุขโูพ ุฑุง ุชูุถุญ ูโุฏููุฏ.


## ๐ ูุนุฑู
**ุงุจุฒุงุฑ Abdal AnyDesk Remote IP Detector** ฺฉ ุงุจุฒุงุฑ ุงุซุจุงุช ุขุณุจโูพุฐุฑ (PoC) ุงุณุช ฺฉู ุงุฒ ฺฉ **ุขุณุจโูพุฐุฑ Zero-Day** ฺฉู ุฏุฑ ุชุงุฑุฎ **ฒท ุงฺฉุชุจุฑ ฒฐฒด** ุฏุฑ ูฺฺฏ "Allow Direct Connections" ูุฑูโุงูุฒุงุฑ AnyDesk ฺฉุดู ุดุฏูุ ุณูุกุงุณุชูุงุฏู ูโฺฉูุฏ. ููุช ุงู ฺฏุฒูู ูุนุงู ู ูพูุฑุช ุงุชุตุงู ุฑู ทฐทฐ ุฏุฑ ุณุณุชู ููุงุฌู ุชูุธู ูโุดูุฏุ ููุงุฌู ูโุชูุงูุฏ ุชููุง ุจุง ุฏุงุดุชู ุขโุฏ AnyDesk ูุฏูุ ุขุฏุฑุณ ุขโูพ ุนููู ุขู ุฑุง ุจุฏูู ูุงุฒ ุจู ุชุบุฑ ุชูุธูุงุช ุฏุฑ ุณุณุชู ูุฏู ุจู ุฏุณุช ุขูุฑุฏ. ููฺููุ ุงฺฏุฑ ูุฑ ุฏู ุณุณุชู ุฏุฑ ฺฉ ุดุจฺฉู ุจุงุดูุฏุ ููุงุฌู ูโุชูุงูุฏ ุจู ุขุฏุฑุณ ุขโูพ ุฎุตูุต ูุฏู ูุฒ ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.

## ๐ ููุง ฺฉู ุงุฒ ุขุณุจโูพุฐุฑ
ุงู **ุขุณุจโูพุฐุฑ Zero-Day** ุฏุฑ ูฺฺฏ "Allow Direct Connections" ูุฑูโุงูุฒุงุฑ AnyDesk ุงุทูุงุนุงุช ุญุณุงุณ ุขโูพ ุณุณุชู ูุฏู ุฑุง ุฏุฑ ูุนุฑุถ ุฎุทุฑ ูุฑุงุฑ ูโุฏูุฏ. ููุงุฌูุงู ูโุชูุงููุฏ ุงุฒ ุงู ููุต ุจุฑุง ุฏุณุชุฑุณ ุจู ุขุฏุฑุณ ุขโูพ ุนููู ูุ ุฏุฑ ุดุฑุงุท ุฎุงุตุ ุขุฏุฑุณ ุขโูพ ุฎุตูุต ุณุณุชู ูุฏู ุงุณุชูุงุฏู ฺฉููุฏ. ุงู ุขุณุจโูพุฐุฑ ุฎุทุฑุงุช ุฌุฏ ุจุฑุง ุญุฑู ุฎุตูุต ุงุฌุงุฏ ูโฺฉูุฏุ ุจูโูฺู ุฏุฑ ุงุจุฒุงุฑูุง ุฏุณุชุฑุณ ุงุฒ ุฑุงู ุฏูุฑ ฺฉู ุชูุธูุงุช ุงููุช ุขููุง ุจู ุฏุฑุณุช ูุญุงูุธุช ูุดุฏูโุงูุฏ.

ุฒูุงู ฺฉู ฺฏุฒูู Allow Direct Connections ุฏุฑ ุณุณุชู ููุงุฌู ูุนุงู ุจุงุดุฏุ AnyDesk ุจูโุตูุฑุช ูุงุฎูุงุณุชู ุขุฏุฑุณ ุขโูพ ุนููู ุฏุณุชฺฏุงู ูุฏู ุฑุง ุฏุฑ ุชุฑุงูฺฉ ุดุจฺฉู ุงูุดุง ูโฺฉูุฏ. ุงู ุขุฏุฑุณ ุขโูพ ุงุฒ ุทุฑู ุดููุฏ ุชุฑุงูฺฉ ุดุจฺฉู ุฑู ุณุณุชู ููุงุฌู ุจูโุฑุงุญุช ูุงุจู ุดูุงุณุง ุงุณุช. ุฏุฑ ุตูุฑุช ฺฉู ูุฑ ุฏู ุณุณุชู ุฏุฑ ฺฉ ุดุจฺฉู ูุญู ุจุงุดูุฏุ ุขุฏุฑุณ ุขโูพ ุฎุตูุต ูุฏู ูุฒ ูุงุจู ุดูุงุณุง ุฎูุงูุฏ ุจูุฏ. ุฏุฑ ุชุตูุฑ ุฒุฑุ ูุชุฌู ุดููุฏ ุชุฑุงูฺฉ ุดุจฺฉู ุชูุณุท ุงุจุฒุงุฑ Abdal Sniffer ูุดุงูุฏู ูโุดูุฏ ฺฉู ูุญูู ุงูุดุง ุงู ุงุทูุงุนุงุช ุฑุง ูุดุงู ูโุฏูุฏ.

<p align="center"><img src="vulnerability-overview-01.png?raw=true"></p>

### ๐ ุฌุฒุฆุงุช CVE
ุงู ุขุณุจโูพุฐุฑ ุจูโุทูุฑ ุฑุณู ุจุง ุดูุงุณู **CVE-2024-52940** ุซุจุช ุดุฏู ุงุณุช.  
ุงู ุซุจุช ุชูุณุท **NIST** (ูุคุณุณู ูู ุงุณุชุงูุฏุงุฑุฏ ู ููุงูุฑ)ุ **Tenable**ุ ู **MITRE**ุ ฺฉ ุณุงุฒูุงู ูุดุงูุฑูโุฏููุฏู ุจู ุฏููุช ุงุงูุงุช ูุชุญุฏู ุฏุฑ ุญูุฒูโูุง ุนูู ู ููุ ุจู ูุงู **ุงุจุฑุงูู ุดูุน (EbraSha)** ุงูุฌุงู ุดุฏู ุงุณุช.

ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑุ ุจู ููฺฉโูุง ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:
- [ุตูุญู CVE-2024-52940 ุฏุฑ NVD (NIST)](https://nvd.nist.gov/vuln/detail/CVE-2024-52940)
- [ุตูุญู CVE ุฏุฑ ุณุงุช Tenable](https://www.tenable.com/cve/CVE-2024-52940)
- [ุตูุญู CVE ุฏุฑ ุณุงุช MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52940)


## โจ ูุงุจูุช ูุง

* ุฏุฑุงูุช ุขุฏุฑุณ IP ุนููู ุณุณุชู ูุฏู ุฏุฑ ุตูุฑุช ุฏุงุดุชู ID AnyDesk.
* ฺฉุดู ุขุฏุฑุณ IP ุฎุตูุต ุฏุฑ ุตูุฑุช ุงุชุตุงู ุฏู ุณุณุชู ุฏุฑ ฺฉ ุดุจฺฉู ูุญู.
* ูุตุจ ุณุฑุน ู ุงุฌุฑุง ุขุณุงู PoC.
* ุจุฏูู ูุงุฒ ุจู ูุงุจุณุชฺฏโูุง ูพฺุฏูุ

## ๐๏ธ ุชูุธู ูุญุท ุชูุณุนู
- **.NET 6**
- **Visual Studio 2022**

## ๐ฅ ูพุดโูุงุฒูุง
ุจุฑุง ุงุฌุฑุง ุงู PoCุ ูฺ ูพุดโูุงุฒ ุฎุงุต ูุงุฒู ูุณุช.

## ๐ฅ ุฏุงูููุฏ
ุจุฑุง ุฏุงูููุฏ ูุณุฎูโูุง ุงุฌุฑุง ุงู PoCุ ูุทูุงู ุจู ุตูุญู ูุณุฎูโูุง ุฑุณู ุฏุฑ GitHub ูุฑุงุฌุนู ฺฉูุฏ. ุงุฒ ุงู ุทุฑูุ ูโุชูุงูุฏ ูุณุฎู ฺฉุงููพุงูโุดุฏู ู ุขูุงุฏู ุงุณุชูุงุฏู ุฑุง ุฏุฑุงูุช ฺฉูุฏ:

- [ุฏุงูููุฏ ูุณุฎูโูุง ุงุฌุฑุง PoC ุงุฒ GitHub](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/releases)



## ๐ฆ ุฑุงูโุงูุฏุงุฒ ู ุงุณุชูุงุฏู

1. ูุนุงูโุณุงุฒ ุงุฑุชุจุงุท ูุณุชูู ุฏุฑ AnyDesk: AnyDesk ุฑุง ุจุงุฒ ฺฉุฑุฏู ู ุจู Settings > Connection ุจุฑูุฏ. ฺฏุฒูู Allow direct connections ุฑุง ูุนุงู ฺฉูุฏ ู ูพูุฑุช ุฑุง ุฑู 7070 ุชูุธู ููุงุฏ.
2. ุงุฌุฑุง ุงุจุฒุงุฑ PoC: ุงุจุฒุงุฑ Abdal AnyDesk Remote IP Detector ุฑุง ุงุฌุฑุง ฺฉูุฏ.
3. ูุฑูุฏ ID ูุฏู: ุฏุฑ ุจุฑูุงูู AnyDesk ุจุฑ ุฑู ุณุณุชู ุฎูุฏุชุงูุ ID ุณุณุชู ูุฏู ุฑุง ูุงุฑุฏ ฺฉูุฏ.
4. ุฏุฑุงูุช IP ุงุฒ ุทุฑู ุดููุฏ ุชุฑุงูฺฉ ุดุจฺฉู: ูพุณ ุงุฒ ูุงุฑุฏ ฺฉุฑุฏู ID ูุฏู ุฏุฑ AnyDeskุ ุงุจุฒุงุฑ PoC ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุง ุดููุฏ ุชุฑุงูฺฉ ุดุจฺฉู ุณุณุชู ุดูุงุ ุขุฏุฑุณ IP ุนููู ุณุณุชู ูุฏู ุฑุง ุดูุงุณุง ู ููุงุด ูโุฏูุฏ. ุงฺฏุฑ ูุฑ ุฏู ุณุณุชู ุฏุฑ ฺฉ ุดุจฺฉู ูุญู ุจุงุดูุฏุ ุขุฏุฑุณ IP ุฎุตูุต ุณุณุชู ูุฏู ูุฒ ููุงุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.


## ๐ ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ
ุงุจุฒุงุฑ ุจู ุตูุฑุช ุฒุฑ ุฎุฑูุฌ ุฎูุงูุฏ ุฏุงุดุช:

* ุขุฏุฑุณ IP ุนููู ุณุณุชู ูุฏู.
* ุขุฏุฑุณ IP ุฎุตูุต ุงฺฏุฑ ูุฑ ุฏู ุณุณุชู ุฏุฑ ฺฉ ุดุจฺฉู ูุญู ุจุงุดูุฏ.

## ๐ ูุณุฎูโูุง ุขุณุจโูพุฐุฑ

ุงู ุขุณุจโูพุฐุฑ ุจุฑ **ูุณุฎู 8.1.0 ู ูพุงูโุชุฑ ุงุฒ AnyDesk** ุชุฃุซุฑ ูโฺฏุฐุงุฑุฏ. ุฏุฑ ุญุงู ุญุงุถุฑุ ูฺ ูุณุฎู ุงุตูุงุญโุดุฏูโุง ุจุฑุง ุฑูุน ุงู ูุดฺฉู ููุชุดุฑ ูุดุฏู ุงุณุช.


## โ ุฑูุน ุฎุทุฑ
ูุชุฃุณูุงูู ุฏุฑ ุญุงู ุญุงุถุฑ ูฺ ุฑุงูโุญู ุงุฒ ุณูุช ฺฉุงุฑุจุฑุงู ุจุฑุง ุฑูุน ุงู ุขุณุจโูพุฐุฑ ูุฌูุฏ ูุฏุงุฑุฏ. ุจุฑุง ุญู ฺฉุงูู ุงู ูุดฺฉูุ ูุงุฒ ุจู ุงูุชุดุงุฑ ฺฉ ุจูโุฑูุฒุฑุณุงู ุง ูพฺ ุชูุณุท ุชู ุชูุณุนู AnyDesk ุงุณุช.

## ๐๏ธ ุงุนุชุจุงุฑ
- **ฺฉุดู ุขุณุจโูพุฐุฑ ู ุชูุณุนู PoC**: ุงุจุฑุงูู ุดูุน (EbraSha)
- [ุงุจุฑุงูู ุดูุน ุฏุฑ ููฺฉุฏู](https://www.linkedin.com/in/profshafiei/)

 
## โค๏ธ ุญูุงุช ูุงู
ุงฺฏุฑ ุงู ูพุฑูฺู ุจุฑุง ุดูุง ููุฏ ุจูุฏ ู ูุงู ุจู ุญูุงุช ุงุฒ ุชูุณุนู ุจุดุชุฑ ูุณุชุฏุ ูุทูุงู ุฏุฑ ูุธุฑ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ฺฉูฺฉ ูุงู ฺฉูุฏ:
- [ุงูุฌุง ุงูุฏุง ฺฉูุฏ](https://alphajet.ir/abdal-donation)

## ๐คต ุจุฑูุงููโููุณ
ุจุง ุนุดู ู ุนูุงูู ุณุงุฎุชู ุดุฏู ุชูุณุท **ุงุจุฑุงูู ุดูุน (EbraSha)**
- **ุงูู**: Prof.Shafiei@Gmail.com
- **ุชูฺฏุฑุงู**: [@ProfShafiei](https://t.me/ProfShafiei)

## โ๏ธ ฺฏุฒุงุฑุด ูุดฺฉูุงุช
ุงฺฏุฑ ุจุง ูุดฺฉู ุฏุฑ ูพฺฉุฑุจูุฏ ููุงุฌู ุดุฏุฏ ุง ฺุฒ ูุทุงุจู ุงูุชุธุงุฑ ุดูุง ฺฉุงุฑ ูฺฉุฑุฏุ ูุทูุงู ุงุฒ ุทุฑู ุงูู Prof.Shafiei@Gmail.com ุชูุงุณ ุจฺฏุฑุฏ. ููฺูู ูโุชูุงูุฏ ูุดฺฉูุงุช ุฑุง ุฏุฑ GitLab ุง GitHub ฺฏุฒุงุฑุด ุฏูุฏ.

## โ๏ธ  ุณูุจ ูุณุฆููุช ูุงููู
ุงู Proof of Concept (PoC) ุตุฑูุงู ุจุฑุง ุงูุฏุงู ุขููุฒุด ุงุฑุงุฆู ุดุฏู ุงุณุช. ุงุณุชูุงุฏู ุบุฑูุฌุงุฒ ุงุฒ ุงู ฺฉุฏ ุฏุฑ ุณุณุชูโูุง ฺฉู ูุงูฺฉ ุขู ูุณุชุฏ ุง ุงุฌุงุฒู ุตุฑุญ ุจุฑุง ุขุฒูุงุด ุขูโูุง ูุฏุงุฑุฏุ ุบุฑูุงููู ู ุบุฑุงุฎูุงู ุงุณุช. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู PoCุ ุดูุง ููุงููุช ูโฺฉูุฏ ฺฉู ุชูุงู ูุณุฆููุช ุณูุกุงุณุชูุงุฏู ุง ุขุณุจโูุง ฺฉู ููฺฉู ุงุณุช ุจู ุฏูุจุงู ุฏุงุดุชู ุจุงุดุฏุ ุจุฑ ุนูุฏู ุดูุงุณุช. ููุณูุฏู ูฺ ูุณุฆููุช ุฏุฑ ูุจุงู ุงูุฏุงูุงุช ูุงุด ุงุฒ ุงุทูุงุนุงุช ุงุฑุงุฆู ุดุฏู ุฏุฑ ุงู ูุฎุฒู ููโูพุฐุฑุฏ. ููุดู ูุทูุฆู ุดูุฏ ฺฉู ูุจู ุงุฒ ุงูุฌุงู ูุฑฺฏููู ุชุณุช ุงููุชุ ูุฌูุฒูุง ูุงุฒู ุฑุง ุฏุฑุงูุช ฺฉุฑุฏูโุงุฏ.
