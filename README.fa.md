# AnyDesk IP Leak Vulnerability CVE-2024-52940

## 🎤 ترجمه اطلاعات نرم افزار
- [English](README.md)
- [Deutsch](README.de.md)
- [فارسی](README.fa.md)

## 📸 پیش نمایس
 
<p align="center"><img src="abdal-anydesk-remote-ip-detector-proof.gif?raw=true"></p>

## 🎥 ویدیوهای اثبات آسیب‌پذیری

برای مشاهده عملکرد **آسیب‌پذیری نشت آی‌پی AnyDesk**، می‌توانید ویدیوهای اثبات آسیب‌پذیری (PoC) زیر را دانلود کنید:

- [📥 دانلود ویدیو اثبات ۰۱](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof.mp4)
- [📥 دانلود ویدیو اثبات ۰۲](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof-2.mp4)
- پیشنهادی - [📥 دانلود ویدیو اثبات ۰۳](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/raw/main/abdal-anydesk-remote-ip-detector-proof-3.mp4)

این ویدیوها نحوه عملکرد آسیب‌پذیری را نشان می‌دهند و مراحل و تأثیر آن بر حریم خصوصی آدرس آی‌پی را توضیح می‌دهند.


## 💎 معرفی
**ابزار Abdal AnyDesk Remote IP Detector** یک ابزار اثبات آسیب‌پذیری (PoC) است که از یک **آسیب‌پذیری Zero-Day** که در تاریخ **۲۷ اکتبر ۲۰۲۴** در ویژگی "Allow Direct Connections" نرم‌افزار AnyDesk کشف شده، سوءاستفاده می‌کند. وقتی این گزینه فعال و پورت اتصال روی ۷۰۷۰ در سیستم مهاجم تنظیم می‌شود، مهاجم می‌تواند تنها با داشتن آی‌دی AnyDesk هدف، آدرس آی‌پی عمومی آن را بدون نیاز به تغییر تنظیمات در سیستم هدف به دست آورد. همچنین، اگر هر دو سیستم در یک شبکه باشند، مهاجم می‌تواند به آدرس آی‌پی خصوصی هدف نیز دسترسی پیدا کند.

## 💀 نمای کلی از آسیب‌پذیری
این **آسیب‌پذیری Zero-Day** در ویژگی "Allow Direct Connections" نرم‌افزار AnyDesk اطلاعات حساس آی‌پی سیستم هدف را در معرض خطر قرار می‌دهد. مهاجمان می‌توانند از این نقص برای دسترسی به آدرس آی‌پی عمومی و، در شرایط خاص، آدرس آی‌پی خصوصی سیستم هدف استفاده کنند. این آسیب‌پذیری خطرات جدی برای حریم خصوصی ایجاد می‌کند، به‌ویژه در ابزارهای دسترسی از راه دور که تنظیمات امنیتی آنها به درستی محافظت نشده‌اند.

زمانی که گزینه Allow Direct Connections در سیستم مهاجم فعال باشد، AnyDesk به‌صورت ناخواسته آدرس آی‌پی عمومی دستگاه هدف را در ترافیک شبکه افشا می‌کند. این آدرس آی‌پی از طریق شنود ترافیک شبکه روی سیستم مهاجم به‌راحتی قابل شناسایی است. در صورتی که هر دو سیستم در یک شبکه محلی باشند، آدرس آی‌پی خصوصی هدف نیز قابل شناسایی خواهد بود. در تصویر زیر، نتیجه شنود ترافیک شبکه توسط ابزار Abdal Sniffer مشاهده می‌شود که نحوه افشای این اطلاعات را نشان می‌دهد.

<p align="center"><img src="vulnerability-overview-01.png?raw=true"></p>

### 🔍 جزئیات CVE
این آسیب‌پذیری به‌طور رسمی با شناسه **CVE-2024-52940** ثبت شده است.  
این ثبت توسط **NIST** (مؤسسه ملی استاندارد و فناوری)، **Tenable**، و **MITRE**، یک سازمان مشاوره‌دهنده به دولت ایالات متحده در حوزه‌های علمی و فنی، به نام **ابراهیم شفیعی (EbraSha)** انجام شده است.

برای اطلاعات بیشتر، به لینک‌های زیر مراجعه کنید:
- [صفحه CVE-2024-52940 در NVD (NIST)](https://nvd.nist.gov/vuln/detail/CVE-2024-52940)
- [صفحه CVE در سایت Tenable](https://www.tenable.com/cve/CVE-2024-52940)
- [صفحه CVE در سایت MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52940)


## ✨ قابلیت ها

* دریافت آدرس IP عمومی سیستم هدف در صورت داشتن ID AnyDesk.
* کشف آدرس IP خصوصی در صورت اتصال دو سیستم در یک شبکه محلی.
* نصب سریع و اجرای آسان PoC.
* بدون نیاز به وابستگی‌های پیچیده؛

## 🛠️ تنظیم محیط توسعه
- **.NET 6**
- **Visual Studio 2022**

## 🔥 پیش‌نیازها
برای اجرای این PoC، هیچ پیش‌نیاز خاصی لازم نیست.

## 📥 دانلود
برای دانلود نسخه‌های اجرایی این PoC، لطفاً به صفحه نسخه‌های رسمی در GitHub مراجعه کنید. از این طریق، می‌توانید نسخه کامپایل‌شده و آماده استفاده را دریافت کنید:

- [دانلود نسخه‌های اجرایی PoC از GitHub](https://github.com/ebrasha/abdal-anydesk-remote-ip-detector/releases)



## 📦 راه‌اندازی و استفاده

1. فعال‌سازی ارتباط مستقیم در AnyDesk: AnyDesk را باز کرده و به Settings > Connection بروید. گزینه Allow direct connections را فعال کنید و پورت را روی 7070 تنظیم نمایید.
2. اجرای ابزار PoC: ابزار Abdal AnyDesk Remote IP Detector را اجرا کنید.
3. ورود ID هدف: در برنامه AnyDesk بر روی سیستم خودتان، ID سیستم هدف را وارد کنید.
4. دریافت IP از طریق شنود ترافیک شبکه: پس از وارد کردن ID هدف در AnyDesk، ابزار PoC به صورت خودکار با شنود ترافیک شبکه سیستم شما، آدرس IP عمومی سیستم هدف را شناسایی و نمایش می‌دهد. اگر هر دو سیستم در یک شبکه محلی باشند، آدرس IP خصوصی سیستم هدف نیز نمایش داده خواهد شد.


## 😎 خروجی مورد انتظار
ابزار به صورت زیر خروجی خواهد داشت:

* آدرس IP عمومی سیستم هدف.
* آدرس IP خصوصی اگر هر دو سیستم در یک شبکه محلی باشند.

## 🛑 نسخه‌های آسیب‌پذیر

این آسیب‌پذیری بر **نسخه 8.1.0 و پایین‌تر از AnyDesk** تأثیر می‌گذارد. در حال حاضر، هیچ نسخه اصلاح‌شده‌ای برای رفع این مشکل منتشر نشده است.


## ✅ رفع خطر
متأسفانه در حال حاضر هیچ راه‌حلی از سمت کاربران برای رفع این آسیب‌پذیری وجود ندارد. برای حل کامل این مشکل، نیاز به انتشار یک به‌روزرسانی یا پچ توسط تیم توسعه AnyDesk است.

## 🎖️ اعتبار
- **کشف آسیب‌پذیری و توسعه PoC**: ابراهیم شفیعی (EbraSha)
- [ابراهیم شفیعی در لینکدین](https://www.linkedin.com/in/profshafiei/)

 
## ❤️ حمایت مالی
اگر این پروژه برای شما مفید بود و مایل به حمایت از توسعه بیشتر هستید، لطفاً در نظر داشته باشید که کمک مالی کنید:
- [اینجا اهدا کنید](https://alphajet.ir/abdal-donation)

## 🤵 برنامه‌نویس
با عشق و علاقه ساخته شده توسط **ابراهیم شفیعی (EbraSha)**
- **ایمیل**: Prof.Shafiei@Gmail.com
- **تلگرام**: [@ProfShafiei](https://t.me/ProfShafiei)

## ☠️ گزارش مشکلات
اگر با مشکلی در پیکربندی مواجه شدید یا چیزی مطابق انتظار شما کار نکرد، لطفاً از طریق ایمیل Prof.Shafiei@Gmail.com تماس بگیرید. همچنین می‌توانید مشکلات را در GitLab یا GitHub گزارش دهید.

## ⚠️  سلب مسئولیت قانونی
این Proof of Concept (PoC) صرفاً برای اهداف آموزشی ارائه شده است. استفاده غیرمجاز از این کد در سیستم‌هایی که مالک آن نیستید یا اجازه صریح برای آزمایش آن‌ها ندارید، غیرقانونی و غیراخلاقی است. با استفاده از این PoC، شما موافقت می‌کنید که تمامی مسئولیت سوءاستفاده یا آسیب‌هایی که ممکن است به دنبال داشته باشد، بر عهده شماست. نویسنده هیچ مسئولیتی در قبال اقدامات ناشی از اطلاعات ارائه شده در این مخزن نمی‌پذیرد. همیشه مطمئن شوید که قبل از انجام هرگونه تست امنیتی، مجوزهای لازم را دریافت کرده‌اید.
